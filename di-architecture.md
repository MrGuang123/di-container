# DI å®¹å™¨æ¶æ„ä¸æµç¨‹å›¾

## ğŸ“ æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DI å®¹å™¨ç³»ç»Ÿ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Container   â”‚â—„â”€â”€â”€â”€â”€â”‚ ContainerModuleâ”‚    â”‚  Decorators  â”‚ â”‚
â”‚  â”‚   (æ ¸å¿ƒ)     â”‚      â”‚   (æ¨¡å—åŒ–)    â”‚      â”‚  (@Inject)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                                                       â”‚
â”‚         â”‚ ç®¡ç†                                                  â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Provider æ³¨å†Œè¡¨                             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ClassProvider â”‚  â”‚ValueProvider â”‚  â”‚FactoryProviderâ”‚ â”‚  â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ useClass     â”‚  â”‚  useValue    â”‚  â”‚  useFactory  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ + inject[]   â”‚  â”‚              â”‚  â”‚  + deps[]    â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                                       â”‚
â”‚         â”‚ è§£æä¾èµ–                                              â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              å®ä¾‹ç¼“å­˜å±‚                                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚  Singleton Cache     â”‚  â”‚   Transient          â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  (å•ä¾‹ç¼“å­˜)          â”‚  â”‚   (æ¯æ¬¡åˆ›å»ºæ–°å®ä¾‹)    â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ ä¾èµ–è§£ææµç¨‹å›¾

```
                    å¼€å§‹è§£æ resolve(Token)
                            â”‚
                            â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ æ£€æŸ¥å¾ªç¯ä¾èµ–         â”‚
                  â”‚ (stack ä¸­æ˜¯å¦æœ‰æ­¤ Token)â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                 â”‚
                   æ˜¯                å¦
                    â”‚                 â”‚
                    â–¼                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ æŠ›å‡ºå¾ªç¯ä¾èµ–  â”‚   â”‚ æŸ¥æ‰¾ Provider    â”‚
            â”‚ é”™è¯¯         â”‚   â”‚ (è‡ªèº« -> çˆ¶å®¹å™¨) â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚                 â”‚
                           æ‰¾åˆ°äº†            æ‰¾ä¸åˆ°
                               â”‚                 â”‚
                               â–¼                 â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ æ£€æŸ¥ä½œç”¨åŸŸ    â”‚    â”‚ æŠ›å‡º Not Foundâ”‚
                     â”‚ Scope?       â”‚    â”‚ é”™è¯¯         â”‚
                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚                   â”‚
            Singleton            Transient
                  â”‚                   â”‚
                  â–¼                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
        â”‚ ç¼“å­˜ä¸­æ˜¯å¦å·²å­˜åœ¨ï¼Ÿâ”‚          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                  â”‚                   â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
         â”‚                 â”‚          â”‚
        æ˜¯                å¦          â”‚
         â”‚                 â”‚          â”‚
         â–¼                 â”‚          â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚          â”‚
   â”‚ è¿”å›ç¼“å­˜  â”‚            â”‚          â”‚
   â”‚ å®ä¾‹     â”‚            â”‚          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚          â”‚
                           â”‚          â”‚
                           â–¼          â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  å®ä¾‹åŒ– instantiate() â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                â”‚                â”‚
              â–¼                â–¼                â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ClassProviderâ”‚  â”‚ValueProviderâ”‚  â”‚FactoryProviderâ”‚
      â”‚             â”‚  â”‚             â”‚  â”‚             â”‚
      â”‚ 1.è·å–injectâ”‚  â”‚ ç›´æ¥è¿”å›    â”‚  â”‚ 1.è§£æ deps â”‚
      â”‚ 2.é€’å½’è§£æ  â”‚  â”‚ useValue    â”‚  â”‚ 2.è°ƒç”¨      â”‚
      â”‚ 3.new Ctor  â”‚  â”‚             â”‚  â”‚   useFactoryâ”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
             â”‚                â”‚                â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ å±æ€§æ³¨å…¥          â”‚
                    â”‚ applyPropertyInjections()â”‚
                    â”‚ (å¤„ç† @Inject è£…é¥°å™¨)â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ ç”Ÿå‘½å‘¨æœŸé’©å­      â”‚
                    â”‚ onInit()         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ Singleton?          â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                 â”‚
                   æ˜¯                å¦
                    â”‚                 â”‚
                    â–¼                 â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
            â”‚ ä¿å­˜åˆ°ç¼“å­˜    â”‚          â”‚
            â”‚ singletons   â”‚          â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                   â”‚                 â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                      è¿”å›å®ä¾‹
```

## ğŸ—ï¸ ä¸‰ç§ Provider ç±»å‹è¯¦è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Provider ç±»å‹                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ ClassProvider (ç±»æä¾›è€…)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ {                                    â”‚
   â”‚   token: TOKENS.Logger,              â”‚
   â”‚   useClass: ConsoleLogger,           â”‚â”€â”€â”
   â”‚   scope: Scope.Singleton             â”‚  â”‚
   â”‚ }                                    â”‚  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                              â”‚
   ä½¿ç”¨åœºæ™¯ï¼šæ³¨å†ŒæœåŠ¡ç±»                        â”‚
   å®ä¾‹åŒ–æ–¹å¼ï¼šnew useClass(...deps)          â”‚
   ä¾èµ–å£°æ˜ï¼šstatic inject = [token1, ...]   â”‚
                                              â”‚
                                              â”‚
2ï¸âƒ£ ValueProvider (å€¼æä¾›è€…)                   â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚ {                                    â”‚  â”‚
   â”‚   token: TOKENS.Config,              â”‚  â”‚
   â”‚   useValue: { appName: "MyApp" }     â”‚â”€â”€â”¤
   â”‚ }                                    â”‚  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                              â”‚
   ä½¿ç”¨åœºæ™¯ï¼šé…ç½®å¯¹è±¡ã€å¸¸é‡                    â”‚
   å®ä¾‹åŒ–æ–¹å¼ï¼šç›´æ¥è¿”å› useValue               â”‚
   ä¾èµ–å£°æ˜ï¼šæ—                                â”‚
                                              â”‚
                                              â”‚
3ï¸âƒ£ FactoryProvider (å·¥å‚æä¾›è€…)               â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚ {                                    â”‚  â”‚
   â”‚   token: TOKENS.Database,            â”‚  â”‚
   â”‚   useFactory: (cfg) => new DB(cfg),  â”‚â”€â”€â”˜
   â”‚   deps: [TOKENS.Config],             â”‚
   â”‚   scope: Scope.Singleton             â”‚
   â”‚ }                                    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   
   ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦å¤æ‚åˆå§‹åŒ–é€»è¾‘
   å®ä¾‹åŒ–æ–¹å¼ï¼šuseFactory(...resolvedDeps)
   ä¾èµ–å£°æ˜ï¼šdeps æ•°ç»„
```

## ğŸ¯ ä¾èµ–æ³¨å…¥æ–¹å¼å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ä¾èµ–æ³¨å…¥æ–¹å¼                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ–¹å¼ä¸€ï¼šæ„é€ å™¨æ³¨å…¥ (Constructor Injection)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ class Greeter {                                        â”‚
â”‚   static inject = [TOKENS.Logger, TOKENS.Config];     â”‚
â”‚   constructor(                                         â”‚
â”‚     private logger: Logger,                            â”‚
â”‚     private config: Config                             â”‚
â”‚   ) {}                                                 â”‚
â”‚ }                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   âœ… ä¼˜ç‚¹ï¼šä¾èµ–æ˜ç¡®ã€ç±»å‹å®‰å…¨ã€æ˜“äºæµ‹è¯•
   âš ï¸  æ³¨æ„ï¼šéœ€è¦å£°æ˜ static inject æ•°ç»„


æ–¹å¼äºŒï¼šå±æ€§æ³¨å…¥ (Property Injection)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ class Greeter {                                        â”‚
â”‚   @Inject(TOKENS.Logger)                               â”‚
â”‚   private logger!: Logger;                             â”‚
â”‚                                                        â”‚
â”‚   @Inject(TOKENS.Config)                               â”‚
â”‚   private config!: Config;                             â”‚
â”‚ }                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   âœ… ä¼˜ç‚¹ï¼šçµæ´»ã€å¯é€‰ä¾èµ–
   âš ï¸  æ³¨æ„ï¼šåœ¨ onInit() åæ‰å¯ç”¨
```

## ğŸŒ³ å®¹å™¨å±‚çº§ç»“æ„

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Root Container â”‚
                    â”‚                  â”‚
                    â”‚ providers: Map   â”‚
                    â”‚ singletons: Map  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                   parent å¼•ç”¨â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚              â”‚              â”‚
              â–¼              â–¼              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚Child Containerâ”‚Child Containerâ”‚Child Containerâ”‚
      â”‚              â”‚ â”‚              â”‚ â”‚              â”‚
      â”‚providers: Mapâ”‚ â”‚providers: Mapâ”‚ â”‚providers: Mapâ”‚
      â”‚singletons:Mapâ”‚ â”‚singletons:Mapâ”‚ â”‚singletons:Mapâ”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‰¹ç‚¹ï¼š
â€¢ å­å®¹å™¨ç»§æ‰¿çˆ¶å®¹å™¨çš„ Provider å®šä¹‰
â€¢ å­å®¹å™¨æœ‰ç‹¬ç«‹çš„ Singleton ç¼“å­˜
â€¢ æŸ¥æ‰¾ Providerï¼šå…ˆæŸ¥è‡ªèº«ï¼Œå†æŸ¥çˆ¶å®¹å™¨
â€¢ å®ä¾‹ç¼“å­˜ï¼šåªåœ¨å½“å‰å®¹å™¨
```

## ğŸ” å¾ªç¯ä¾èµ–æ£€æµ‹æœºåˆ¶

```
å‡è®¾æœ‰å¾ªç¯ä¾èµ–ï¼šA â†’ B â†’ C â†’ A

resolve(A, [])
  â”‚
  â”œâ”€ stack: [A]
  â”‚  resolve(B, [A])
  â”‚    â”‚
  â”‚    â”œâ”€ stack: [A, B]
  â”‚    â”‚  resolve(C, [A, B])
  â”‚    â”‚    â”‚
  â”‚    â”‚    â”œâ”€ stack: [A, B, C]
  â”‚    â”‚    â”‚  resolve(A, [A, B, C])
  â”‚    â”‚    â”‚    â”‚
  â”‚    â”‚    â”‚    â””â”€ âŒ A åœ¨ stack ä¸­ï¼
  â”‚    â”‚    â”‚       æŠ›å‡º CircularDependencyError
  â”‚    â”‚    â”‚       è·¯å¾„ï¼šA -> B -> C -> A
```

## âš™ï¸ å®Œæ•´ä½¿ç”¨æµç¨‹ç¤ºä¾‹

```
ç¬¬1æ­¥ï¼šå®šä¹‰ Tokens
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ const TOKENS = {               â”‚
â”‚   Logger: Symbol("Logger"),    â”‚
â”‚   Config: Symbol("Config")     â”‚
â”‚ }                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬2æ­¥ï¼šå®šä¹‰æœåŠ¡ç±»
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ class ConsoleLogger {          â”‚
â”‚   log(msg: string) {...}       â”‚
â”‚ }                              â”‚
â”‚                                â”‚
â”‚ class Greeter {                â”‚
â”‚   static inject = [            â”‚
â”‚     TOKENS.Logger,             â”‚
â”‚     TOKENS.Config              â”‚
â”‚   ];                           â”‚
â”‚   constructor(                 â”‚
â”‚     private logger,            â”‚
â”‚     private config             â”‚
â”‚   ) {}                         â”‚
â”‚ }                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬3æ­¥ï¼šæ³¨å†Œ Provider
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ const container = new Container();â”‚
â”‚                                â”‚
â”‚ container.register(            â”‚
â”‚   {                            â”‚
â”‚     token: TOKENS.Logger,      â”‚
â”‚     useClass: ConsoleLogger    â”‚
â”‚   },                           â”‚
â”‚   {                            â”‚
â”‚     token: TOKENS.Config,      â”‚
â”‚     useValue: { app: "MyApp" } â”‚
â”‚   },                           â”‚
â”‚   {                            â”‚
â”‚     token: Greeter,            â”‚
â”‚     useClass: Greeter          â”‚
â”‚   }                            â”‚
â”‚ );                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬4æ­¥ï¼šè§£æä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ const greeter =                â”‚
â”‚   container.resolve(Greeter);  â”‚
â”‚                                â”‚
â”‚ // è‡ªåŠ¨æ³¨å…¥ï¼š                   â”‚
â”‚ // 1. Logger å®ä¾‹              â”‚
â”‚ // 2. Config å¯¹è±¡              â”‚
â”‚ // 3. è°ƒç”¨ onInit()            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š æ ¸å¿ƒæ•°æ®ç»“æ„

```
Container ç±»ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ class Container {                    â”‚
â”‚   private providers: Map<Token, Provider>  // Provider å®šä¹‰
â”‚   private singletons: Map<Token, any>      // å•ä¾‹ç¼“å­˜
â”‚   private parent?: Container               // çˆ¶å®¹å™¨å¼•ç”¨
â”‚                                      â”‚
â”‚   register(...providers)             â”‚  // æ³¨å†Œ
â”‚   resolve<T>(token): T               â”‚  // è§£æ
â”‚   createChild(): Container           â”‚  // åˆ›å»ºå­å®¹å™¨
â”‚ }                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

propertyInjections (å…¨å±€ WeakMap)ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WeakMap<                             â”‚
â”‚   Constructor,                       â”‚
â”‚   Array<{                            â”‚
â”‚     key: string | symbol,            â”‚
â”‚     token: Token                     â”‚
â”‚   }>                                 â”‚
â”‚ >                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
å­˜å‚¨ï¼šç±» -> å±æ€§æ³¨å…¥å…ƒæ•°æ®
```

## ğŸ“ å…³é”®æ¦‚å¿µæ€»ç»“

| æ¦‚å¿µ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **Token** | ä¾èµ–çš„å”¯ä¸€æ ‡è¯† | `Symbol("Logger")` æˆ–ç±»æœ¬èº« |
| **Provider** | æè¿°å¦‚ä½•åˆ›å»ºå®ä¾‹ | `{ token, useClass }` |
| **Scope** | å®ä¾‹ç”Ÿå‘½å‘¨æœŸ | `Singleton` / `Transient` |
| **Inject** | å±æ€§æ³¨å…¥è£…é¥°å™¨ | `@Inject(TOKENS.Logger)` |
| **Container** | DI å®¹å™¨æ ¸å¿ƒ | ç®¡ç†æ³¨å†Œå’Œè§£æ |
| **Module** | æ¨¡å—åŒ–æ³¨å†Œ | æ‰¹é‡æ³¨å†Œ Provider |

## ğŸ’¡ è®¾è®¡äº®ç‚¹

1. âœ… **æ— ç¬¬ä¸‰æ–¹ä¾èµ–**ï¼šçº¯ TypeScript å®ç°
2. âœ… **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
3. âœ… **å¾ªç¯ä¾èµ–æ£€æµ‹**ï¼šé˜²æ­¢è¿è¡Œæ—¶é”™è¯¯
4. âœ… **å¤šç§æ³¨å…¥æ–¹å¼**ï¼šæ„é€ å™¨ + å±æ€§æ³¨å…¥
5. âœ… **å±‚çº§å®¹å™¨**ï¼šæ”¯æŒä½œç”¨åŸŸéš”ç¦»
6. âœ… **ç”Ÿå‘½å‘¨æœŸé’©å­**ï¼š`onInit()` åˆå§‹åŒ–
7. âœ… **æ¨¡å—åŒ–**ï¼š`ContainerModule` ç»„ç»‡ä»£ç 

